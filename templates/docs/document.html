{% extends "_layout.html" %}

{% block title %}{{ document.title }} | Anbox documentation{% endblock %}

{% macro create_navigation(nav_items) %}
  <ul>
    {% for element in nav_items %}
    <li>
      {% if element.navlink_href %}
        <a href="{{ element.navlink_href }}"
          {% if request.path == element.navlink_href %}aria-current="page"{% endif %}
        >{{ element.navlink_text }}</a>
      {% else %}
        <strong>{{ element.navlink_text }}</strong>
      {% endif %}

      {% if element.children %}
        {{ create_navigation(element.children) }}
      {% endif %}
    </li>
    {% endfor %}
  </ul>
{% endmacro %}

{% block content %}

<section id="search-docs" class="p-strip--light is-shallow">
  <div class="row">
    <form class="p-search-box u-no-margin--bottom" action="/docs/search">
      <input type="search" class="p-search-box__input" name="q" {% if query %}value="{{ query }}"{% endif %} placeholder="Search documentation" required/>
      <button type="reset" class="p-search-box__reset" alt="reset"><i class="p-icon--close">Reset</i></button>
      <button type="submit" class="p-search-box__button" alt="search"><i class="p-icon--search">Search</i></button>
    </form>
  </div>
</section>

  <section class="p-strip is-shallow">
    <div class="row">
      <aside class="col-3">
        {% if versions | length > 1 %}
        <label for="version-select" class="u-hide">Version</label>
        <select name="version-select" id="version-select" onChange="window.location.href=this.value">
        {% for version in versions %}
          {% set active = docs_version == version['path'] %}
          <option value="{{ version_paths[version['path']] }}"{% if active %} selected{% endif %}>{{ version['version'] }}</option>
        {% endfor %}
        <select>
        {% endif %}

        <nav data-js="navigation" class="p-side-navigation--raw-html" id="{{ navigation['path'] or 'default' }}">
          <a href="#{{ navigation['path'] or 'default' }}" class="p-side-navigation__toggle js-drawer-toggle" aria-controls="{{ navigation['path'] or 'default' }}">
            Toggle side navigation
          </a>
          <div class="p-side-navigation__overlay js-drawer-toggle" aria-controls="{{ navigation['path'] or 'default' }}"></div>
          <div class="p-side-navigation__drawer">
            <div class="p-side-navigation__drawer-header">
              <a href="#" class="p-side-navigation__toggle--in-drawer js-drawer-toggle" aria-controls="{{ navigation['path'] or 'default' }}">
                Toggle side navigation
              </a>
            </div>
            {% for nav_group in navigation.nav_items %}
              {% if nav_group.navlink_text %}
                {% if nav_group.navlink_href %}
                <h3>
                  <a href="{{ nav_group.navlink_href }}" {% if request.path == nav_group.navlink_href %}aria-current="page"{% endif %}>
                    {{ nav_group.navlink_text }}
                  </a>
                </h3>
                {% else %}
                  <h3>{{ nav_group.navlink_text }}</h3>
                {% endif %}
              {% endif %}
              {% if not nav_group.hidden %}
              {{ create_navigation(nav_group.children) }}
              {% endif %}
            {% endfor %}
          </div>
        </nav>
      </aside>
      <main class="col-9" id="main-content">
        <h1>{{ document.title }}</h1>
        {{ document.body_html | safe }}
        <hr />
        <p><i>Last updated {{ document.updated }}.</i></p>
        <div class="p-notification--information">
          <p class="p-notification__content">
            <a href="{{ forum_url }}{{ document.topic_path }}">Help improve this document in the forum</a>.
          </p>
        </div>
      </main>
    </div>
  </section>
{% endblock %}

{% block footer %}
  {{ super() }}
<!-- begin usabilla live embed code -->
<script type="text/javascript">window.lightningjs||function(n){var e="lightningjs";function t(e,t){var r,i,a,o,d,c;return t&&(t+=(/\?/.test(t)?"&":"?")+"lv=1"),n[e]||(r=window,i=document,a=e,o=i.location.protocol,d="load",c=0,function(){n[a]=function(){var t=arguments,i=this,o=++c,d=i&&i!=r&&i.id||0;function s(){return s.id=o,n[a].apply(s,arguments)}return(e.s=e.s||[]).push([o,d,t]),s.then=function(n,t,r){var i=e.fh[o]=e.fh[o]||[],a=e.eh[o]=e.eh[o]||[],d=e.ph[o]=e.ph[o]||[];return n&&i.push(n),t&&a.push(t),r&&d.push(r),s},s};var e=n[a]._={};function s(){e.P(d),e.w=1,n[a]("_load")}e.fh={},e.eh={},e.ph={},e.l=t?t.replace(/^\/\//,("https:"==o?o:"http:")+"//"):t,e.p={0:+new Date},e.P=function(n){e.p[n]=new Date-e.p[0]},e.w&&s(),r.addEventListener?r.addEventListener(d,s,!1):r.attachEvent("onload",s);var l=function(){function n(){return["<!DOCTYPE ",o,"><",o,"><head></head><",t,"><",r,' src="',e.l,'"></',r,"></",t,"></",o,">"].join("")}var t="body",r="script",o="html",d=i[t];if(!d)return setTimeout(l,100);e.P(1);var c,s=i.createElement("div"),h=s.appendChild(i.createElement("div")),u=i.createElement("iframe");s.style.display="none",d.insertBefore(s,d.firstChild).id="lightningjs-"+a,u.frameBorder="0",u.id="lightningjs-frame-"+a,/MSIE[ ]+6/.test(navigator.userAgent)&&(u.src="javascript:false"),u.allowTransparency="true",h.appendChild(u);try{u.contentWindow.document.open()}catch(n){e.domain=i.domain,c="javascript:var d=document.open();d.domain='"+i.domain+"';",u.src=c+"void(0);"}try{var p=u.contentWindow.document;p.write(n()),p.close()}catch(e){u.src=c+'d.write("'+n().replace(/"/g,String.fromCharCode(92)+'"')+'");d.close();'}e.P(2)};e.l&&l()}()),n[e].lv="1",n[e]}var r=window.lightningjs=t(e);r.require=t,r.modules=n}({});window.usabilla_live = lightningjs.require("usabilla_live", "//w.usabilla.com/81b811146612.js");</script>
<!-- end usabilla live embed code -->
{% endblock %}
